---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { supabase } from '@/lib/supabase';

const { slug } = Astro.params;
const { data: page } = await supabase
  .from('pages')
  .select('*')
  .eq('slug', slug)
  .eq('is_published', true)
  .single();

if (!page) {
  return Astro.redirect('/');
}
---
<BaseLayout title={page.title} description={page.meta_description || ''}>
  <article class="single-page">
    <div class="container">
      <h1>{page.title}</h1>
      <div class="page-content prose" set:html={page.content || ''} />
    </div>
  </article>
</BaseLayout>
